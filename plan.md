# AI 协同小说创作系统：多智能体协作架构计划

## 🎯 目标
构建一个以人类通俗小说作家为核心、由多个专业 AI 智能体协同辅助的创作系统，实现：
- 高效生成符合类型文学规范的小说内容
- 保持逻辑一致性、叙述节奏与读者体验
- 支持知识库驱动的世界观与人物管理
- 允许人类在关键节点介入决策（人机协同）

---

## 👥 智能体角色定义

| 角色 | 职责 | 关键能力 |
|------|------|--------|
| **通俗小说作家**（Writer） | 主笔生成章节正文 | 调用 LLM 生成连贯叙事文本 |
| **大纲灵感提供者**（Planner） | 设计故事主线、章节梗概、转折点 | 熟悉经典叙事结构（如三幕剧、英雄之旅） |
| **文档管理严**（Archivist） | 管理人物卡、世界观设定、章节版本 | 读写结构化文档（JSON/Markdown），支持 Git 版本控制 |
| **读者体验编辑**（Editor） | 优化可读性、情感张力、避免冗余 | 使用 readability 分析、情感强度评估 |
| **逻辑一致性顾问**（Consistency Checker） | 校验时间线、人物行为、因果链 | 查询知识库，检测矛盾 |
| **对话策略专家**（Dialogue Specialist） | 优化角色对话风格、口吻、潜台词 | 匹配角色性格与情境 |
| **环境描写专家**（World Builder） | 丰富场景细节、感官描写（视觉/听觉/气味等） | 调用地点/文化/历史知识库 |
| **叙述节奏专家**（Pacing Advisor） | 控制快慢节奏、悬念密度、段落分布 | 分析动作 vs 描述比例，建议调整 |
| **去除AI文字编辑**（Pacing Advisor） | 专门识别和去除 AI 生成文本的痕迹，使文字听起来更自然、更有人味 | 改写文章，去除AI味 |

> 所有智能体共享一个中央知识库，确保信息同步。

---

## 🧠 知识库需求

- **内容类型**：
  - 人物档案（姓名、性格、关系网、成长弧）
  - 世界观设定（地理、科技水平、魔法规则、社会结构）
  - 已写章节全文（带元数据：时间、POV、关键事件）
- **技术实现**：
  - 使用 **LlamaIndex** 构建向量索引
  - 存储于 **Chroma**（本地）或 **Pinecone**（云端）
  - 支持语义检索与结构化过滤（如 `character="主角"`）

---

## 🔁 协作流程（分阶段工作流）

采用 **LangGraph 定义状态机**，确保流程可控：

1. **构思阶段**  
   - Planner 提出 3 个故事方向 → 人类选择 → 细化大纲
2. **初稿生成**  
   - Writer 撰写章节，同时调用 World Builder 和 Dialogue Specialist 增强描写
3. **一致性校验**  
   - Consistency Checker + Pacing Advisor 并行审查 → 返回问题列表
4. **编辑优化**  
   - Editor 整合建议，重写润色 → 人类审核
5. **归档**  
   - Archivist 将终稿存入知识库，更新人物/事件状态

> 支持回退到任意前序阶段（如人类不满意可退回“初稿生成”）。

---

## 👤 人机协同机制

- **关键节点人工介入**：
  - 大纲确认
  - 章节终审
  - 风格/节奏重大调整
- **实现方式**：
  - 使用 AutoGen 的 `UserProxyAgent` 暂停流程等待输入
  - 可选 Gradio 界面展示草稿、专家建议、问题高亮

---

## 🛠️ 技术栈建议

| 组件 | 推荐方案 |
|------|--------|
| 多智能体框架 | **AutoGen**（v0.2+） + **LangGraph**（来自 LangChain） |
| 知识库 | **LlamaIndex** + **Chroma**（本地） / **Pinecone**（云端） |
| LLM 后端 | **Claude 3.5 Sonnet** 或 **GPT-4o**（长上下文、强推理） |
| 前端界面 | **Gradio**（快速搭建审核面板） |
| 文档管理 | 自动保存为 Markdown + **Git** 版本追踪 |

---

## ✅ 成功标准

- 人类作家主导创意方向，AI处理执行性任务
- 输出章节逻辑自洽、节奏合理、描写生动
- 知识库实时更新，支持跨章节一致性
- 人类可在 5 分钟内完成一章审核与微调

---

## 使用例子
1.人类输入故事梗概/大纲
2.系统接受后，各agent开始协作创作，调试阶段需要输出协作过程和思考过程，以便调整提示词
3.在产出大纲，人物，每n章后提供给人类评审修改；
4.评审后以人类意见进行返工
5.循环创作-评审过程，直到完结
6.支持续写功能